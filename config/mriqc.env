# MRIQC pipeline config (sourced by bash)
#
# Recommended stable version: MRIQC 24.0.2
# - Releases: https://github.com/nipreps/mriqc/releases/tag/24.0.2
# - Docker tag: nipreps/mriqc:24.0.2
#
# Place your container image under $CONTAINERS_ROOT, e.g.:
#   apptainer pull ${CONTAINERS_ROOT}/mriqc-24.0.2.sif docker://nipreps/mriqc:24.0.2

# ---- outputs ----
DERIV_ROOT="${PROJECT_ROOT}/derivatives/mriqc"

# ---- work & logs ----
WORK_ROOT="${PROJECT_ROOT}/work/mriqc"
PARTICIPANTS_TSV="${WORK_ROOT}/participants.tsv"

# Optional: reuse a shared PyBIDS DB directory for faster indexing
BIDS_DB_DIR="${PROJECT_ROOT}/work/pybids_db"
MRIQC_USE_BIDS_DB="${MRIQC_USE_BIDS_DB:-1}"
MRIQC_BIDS_DB_WIPE="${MRIQC_BIDS_DB_WIPE:-0}"

# ---- container ----
MRIQC_SIF="${CONTAINERS_ROOT}/mriqc-24.0.2.sif"

# ---- concurrency (how many subjects in parallel) ----
MAX_JOBS="${MAX_JOBS:-${N_JOBS_DEFAULT:-2}}"

# ---- per-job resources (inside one MRIQC run) ----
# MRIQC CLI uses --nprocs/--omp-nthreads and --mem_gb
NPROCS="${NPROCS:-8}"
OMP_NTHREADS="${OMP_NTHREADS:-4}"
MEM_GB="${MEM_GB:-16}"

# ---- behavior ----
# By default, disable IQM submission to the public MRIQC WebAPI.
# See: https://mriqc.readthedocs.io/en/latest/dsa.html
NO_SUB="${NO_SUB:-1}"

# Only run specific modalities (whitespace-separated), e.g. "T1w bold".
# Leave empty to let MRIQC decide based on dataset contents.
MRIQC_MODALITIES="${MRIQC_MODALITIES:-}"

# Cleanup behavior
CLEAN_WORK_ON_SUCCESS="${CLEAN_WORK_ON_SUCCESS:-1}"
WIPE_WORKDIR_ON_START="${WIPE_WORKDIR_ON_START:-0}"

# Extra CLI args (string): appended verbatim (use with care)
MRIQC_EXTRA_ARGS="${MRIQC_EXTRA_ARGS:-}"
